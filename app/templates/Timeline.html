<!DOCTYPE html>
<html lang="en">
  <body>
    <h1>Timeline Posts</h1>

    <form id="timelineForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br>

        <label for="content">Content:</label>
        <textarea id="content" name="content" required></textarea><br>

        <button type="submit">Submit</button>
    </form>
    <script>
        document.getElementById('timelineForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const jsonData = {};
            formData.forEach((value, key) => jsonData[key] = value);

            fetch('/api/timeline_post', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                // Update timelinePosts with the new post
                displayTimelinePosts();
            })
            .catch(error => console.error('Error:', error));
        });

        function displayTimelinePosts() {
            fetch('/api/timeline_post', {
                method: 'GET'
            })
            .then(response => response.json())
            .then(data => {
                const timelinePosts = data.timeline_posts;
                const timelinePostsContainer = document.getElementById('timelinePosts');
                timelinePostsContainer.innerHTML = '';

                timelinePosts.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.innerHTML = `
                        <p>Name: ${post.name}</p>
                        <p>Email: ${post.email}</p>
                        <p>Content: ${post.content}</p>
                        <hr>
                    `;
                    timelinePostsContainer.appendChild(postElement);
                });
            })
            .catch(error => console.error('Error:', error));
        }

        // Initial display of timeline posts on page load
        displayTimelinePosts();
    </script>
  </body>
    
</html>