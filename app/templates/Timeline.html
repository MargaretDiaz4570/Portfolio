<!DOCTYPE html>
<html lang="en">
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta property="og:title" content="Personal Portfolio">
        <meta property="og:description" content="My Personal Portfolio">
        <meta property="og:url" content="{{ url }}">
    
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
            rel="stylesheet">
    
        <link lang='sass' rel="stylesheet" href="./static/styles/main.css">
        <link rel='icon' href='./static/img/favicon.ico' type='image/x-icon' />
        <title>{{ title }}</title>
    </head>
    
    <body>
        <header class="nav-bar">
            <div class="nav-content">
                    <a href="/"> 
                        <div class="nav-logo">
                        <img src="./static/img/logo.svg" />
                        </div>
                    </a>
            <div class = "nav-links">
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('Work') }}">Experience</a>
                <a href="{{ url_for('Hobbies') }}">Hobbies</a>
                <a href="{{ url_for('Map') }}">Map</a>
            </div>    
            </div>
        </header>
  <body>
    <h1>Post Timeline Here</h1>
    <div class="container">
    <form id="timelineForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br>

        <label for="content">Content:</label>
        <textarea id="content" name="content" required></textarea><br>

        <button type="submit">Submit</button>
    </form>
    <script>
        document.getElementById('timelineForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const jsonData = {};
            formData.forEach((value, key) => jsonData[key] = value);

            fetch('/api/timeline_post', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                // Update timelinePosts with the new post
                displayTimelinePosts();
            })
            .catch(error => console.error('Error:', error));
        });

        function displayTimelinePosts() {
            fetch('/api/timeline_post', {
                method: 'GET'
            })
            .then(response => response.json())
            .then(data => {
                const timelinePosts = data.timeline_posts;
                const timelinePostsContainer = document.getElementById('timelinePosts');
                timelinePostsContainer.innerHTML = '';

                timelinePosts.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.innerHTML = `
                        <p>Name: ${post.name}</p>
                        <p>Email: ${post.email}</p>
                        <p>Content: ${post.content}</p>
                        <hr>
                    `;
                    timelinePostsContainer.appendChild(postElement);
                });
            })
            .catch(error => console.error('Error:', error));
        }

        // Initial display of timeline posts on page load
        displayTimelinePosts();
    </script>
        </div>
  </body>
    
</html>